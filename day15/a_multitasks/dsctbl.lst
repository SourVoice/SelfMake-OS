     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_load_gdtr
     7 00000000                                 	EXTERN	_load_idtr
     8 00000000                                 	EXTERN	_asm_inthandler20
     9 00000000                                 	EXTERN	_asm_inthandler21
    10 00000000                                 	EXTERN	_asm_inthandler27
    11 00000000                                 	EXTERN	_asm_inthandler2c
    12 00000000                                 [FILE "dsctbl.c"]
    13                                          [SECTION .text]
    14 00000000                                 	GLOBAL	_init_gdtidt
    15 00000000                                 _init_gdtidt:
    16 00000000 55                              	PUSH	EBP
    17 00000001 89 E5                           	MOV	EBP,ESP
    18 00000003 56                              	PUSH	ESI
    19 00000004 53                              	PUSH	EBX
    20 00000005 BE 00270000                     	MOV	ESI,2555904
    21 0000000A BB 00001FFF                     	MOV	EBX,8191
    22 0000000F                                 L6:
    23 0000000F 6A 00                           	PUSH	0
    24 00000011 6A 00                           	PUSH	0
    25 00000013 6A 00                           	PUSH	0
    26 00000015 56                              	PUSH	ESI
    27 00000016 83 C6 08                        	ADD	ESI,8
    28 00000019 E8 00000105                     	CALL	_set_segmdesc
    29 0000001E 83 C4 10                        	ADD	ESP,16
    30 00000021 4B                              	DEC	EBX
    31 00000022 79 EB                           	JNS	L6
    32 00000024 68 00004092                     	PUSH	16530
    33 00000029 BE 0026F800                     	MOV	ESI,2553856
    34 0000002E 6A 00                           	PUSH	0
    35 00000030 BB 000000FF                     	MOV	EBX,255
    36 00000035 6A FF                           	PUSH	-1
    37 00000037 68 00270008                     	PUSH	2555912
    38 0000003C E8 000000E2                     	CALL	_set_segmdesc
    39 00000041 68 0000409A                     	PUSH	16538
    40 00000046 68 00280000                     	PUSH	2621440
    41 0000004B 68 0007FFFF                     	PUSH	524287
    42 00000050 68 00270010                     	PUSH	2555920
    43 00000055 E8 000000C9                     	CALL	_set_segmdesc
    44 0000005A 83 C4 20                        	ADD	ESP,32
    45 0000005D 68 00000089                     	PUSH	137
    46 00000062 68 [00000000]                   	PUSH	_tss_a
    47 00000067 6A 67                           	PUSH	103
    48 00000069 68 00270018                     	PUSH	2555928
    49 0000006E E8 000000B0                     	CALL	_set_segmdesc
    50 00000073 68 00000089                     	PUSH	137
    51 00000078 68 [00000070]                   	PUSH	_tss_b
    52 0000007D 6A 67                           	PUSH	103
    53 0000007F 68 00270020                     	PUSH	2555936
    54 00000084 E8 0000009A                     	CALL	_set_segmdesc
    55 00000089 83 C4 20                        	ADD	ESP,32
    56 0000008C 68 00270000                     	PUSH	2555904
    57 00000091 68 0000FFFF                     	PUSH	65535
    58 00000096 E8 [00000000]                   	CALL	_load_gdtr
    59 0000009B 58                              	POP	EAX
    60 0000009C 5A                              	POP	EDX
    61 0000009D                                 L11:
    62 0000009D 6A 00                           	PUSH	0
    63 0000009F 6A 00                           	PUSH	0
    64 000000A1 6A 00                           	PUSH	0
    65 000000A3 56                              	PUSH	ESI
    66 000000A4 83 C6 08                        	ADD	ESI,8
    67 000000A7 E8 000000C1                     	CALL	_set_gatedesc
    68 000000AC 83 C4 10                        	ADD	ESP,16
    69 000000AF 4B                              	DEC	EBX
    70 000000B0 79 EB                           	JNS	L11
    71 000000B2 68 0026F800                     	PUSH	2553856
    72 000000B7 68 000007FF                     	PUSH	2047
    73 000000BC E8 [00000000]                   	CALL	_load_idtr
    74 000000C1 68 0000008E                     	PUSH	142
    75 000000C6 6A 10                           	PUSH	16
    76 000000C8 68 [00000000]                   	PUSH	_asm_inthandler20
    77 000000CD 68 0026F900                     	PUSH	2554112
    78 000000D2 E8 00000096                     	CALL	_set_gatedesc
    79 000000D7 68 0000008E                     	PUSH	142
    80 000000DC 6A 10                           	PUSH	16
    81 000000DE 68 [00000000]                   	PUSH	_asm_inthandler21
    82 000000E3 68 0026F908                     	PUSH	2554120
    83 000000E8 E8 00000080                     	CALL	_set_gatedesc
    84 000000ED 83 C4 28                        	ADD	ESP,40
    85 000000F0 68 0000008E                     	PUSH	142
    86 000000F5 6A 10                           	PUSH	16
    87 000000F7 68 [00000000]                   	PUSH	_asm_inthandler27
    88 000000FC 68 0026F938                     	PUSH	2554168
    89 00000101 E8 00000067                     	CALL	_set_gatedesc
    90 00000106 68 0000008E                     	PUSH	142
    91 0000010B 6A 10                           	PUSH	16
    92 0000010D 68 [00000000]                   	PUSH	_asm_inthandler2c
    93 00000112 68 0026F960                     	PUSH	2554208
    94 00000117 E8 00000051                     	CALL	_set_gatedesc
    95 0000011C 8D 65 F8                        	LEA	ESP,DWORD [-8+EBP]
    96 0000011F 5B                              	POP	EBX
    97 00000120 5E                              	POP	ESI
    98 00000121 5D                              	POP	EBP
    99 00000122 C3                              	RET
   100 00000123                                 	GLOBAL	_set_segmdesc
   101 00000123                                 _set_segmdesc:
   102 00000123 55                              	PUSH	EBP
   103 00000124 89 E5                           	MOV	EBP,ESP
   104 00000126 53                              	PUSH	EBX
   105 00000127 8B 55 0C                        	MOV	EDX,DWORD [12+EBP]
   106 0000012A 8B 4D 10                        	MOV	ECX,DWORD [16+EBP]
   107 0000012D 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   108 00000130 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
   109 00000133 81 FA 000FFFFF                  	CMP	EDX,1048575
   110 00000139 76 08                           	JBE	L17
   111 0000013B C1 EA 0C                        	SHR	EDX,12
   112 0000013E 0D 00008000                     	OR	EAX,32768
   113 00000143                                 L17:
   114 00000143 66 89 13                        	MOV	WORD [EBX],DX
   115 00000146 88 43 05                        	MOV	BYTE [5+EBX],AL
   116 00000149 C1 EA 10                        	SHR	EDX,16
   117 0000014C C1 F8 08                        	SAR	EAX,8
   118 0000014F 83 E2 0F                        	AND	EDX,15
   119 00000152 66 89 4B 02                     	MOV	WORD [2+EBX],CX
   120 00000156 83 E0 F0                        	AND	EAX,-16
   121 00000159 C1 F9 10                        	SAR	ECX,16
   122 0000015C 09 C2                           	OR	EDX,EAX
   123 0000015E 88 4B 04                        	MOV	BYTE [4+EBX],CL
   124 00000161 88 53 06                        	MOV	BYTE [6+EBX],DL
   125 00000164 C1 F9 08                        	SAR	ECX,8
   126 00000167 88 4B 07                        	MOV	BYTE [7+EBX],CL
   127 0000016A 5B                              	POP	EBX
   128 0000016B 5D                              	POP	EBP
   129 0000016C C3                              	RET
   130 0000016D                                 	GLOBAL	_set_gatedesc
   131 0000016D                                 _set_gatedesc:
   132 0000016D 55                              	PUSH	EBP
   133 0000016E 89 E5                           	MOV	EBP,ESP
   134 00000170 53                              	PUSH	EBX
   135 00000171 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   136 00000174 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   137 00000177 8B 5D 14                        	MOV	EBX,DWORD [20+EBP]
   138 0000017A 8B 4D 0C                        	MOV	ECX,DWORD [12+EBP]
   139 0000017D 66 89 42 02                     	MOV	WORD [2+EDX],AX
   140 00000181 88 5A 05                        	MOV	BYTE [5+EDX],BL
   141 00000184 66 89 0A                        	MOV	WORD [EDX],CX
   142 00000187 89 D8                           	MOV	EAX,EBX
   143 00000189 C1 F8 08                        	SAR	EAX,8
   144 0000018C C1 F9 10                        	SAR	ECX,16
   145 0000018F 88 42 04                        	MOV	BYTE [4+EDX],AL
   146 00000192 66 89 4A 06                     	MOV	WORD [6+EDX],CX
   147 00000196 5B                              	POP	EBX
   148 00000197 5D                              	POP	EBP
   149 00000198 C3                              	RET
   150 00000199                                 	GLOBAL	_tss_a
   151                                          [SECTION .data]
   152 00000000                                 	ALIGNB	16
   153 00000000                                 _tss_a:
   154 00000000 00 00 00 00 00 00 00 00 00 00   	RESB	100
       0000000A 00 00 00 00 00 00 00 00 00 00 
       00000014 00 00 00 00 00 00 00 00 00 00 
       0000001E 00 00 00 00 00 00 00 00 00 00 
       00000028 00 00 00 00 00 00 00 00 00 00 
       00000032 00 00 00 00 00 00 00 00 00 00 
       0000003C 00 00 00 00 00 00 00 00 00 00 
       00000046 00 00 00 00 00 00 00 00 00 00 
       00000050 00 00 00 00 00 00 00 00 00 00 
       0000005A 00 00 00 00 00 00 00 00 00 00 
   155 00000064                                 	GLOBAL	_tss_b
   156                                          [SECTION .data]
   157 00000064 00 00 00 00 00 00 00 00 00 00   	ALIGNB	16
       0000006E 00 00 
   158 00000070                                 _tss_b:
   159 00000070 00 00 00 00 00 00 00 00 00 00   	RESB	100
       0000007A 00 00 00 00 00 00 00 00 00 00 
       00000084 00 00 00 00 00 00 00 00 00 00 
       0000008E 00 00 00 00 00 00 00 00 00 00 
       00000098 00 00 00 00 00 00 00 00 00 00 
       000000A2 00 00 00 00 00 00 00 00 00 00 
       000000AC 00 00 00 00 00 00 00 00 00 00 
       000000B6 00 00 00 00 00 00 00 00 00 00 
       000000C0 00 00 00 00 00 00 00 00 00 00 
       000000CA 00 00 00 00 00 00 00 00 00 00 
